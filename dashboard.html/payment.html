<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Payment Info - Student Dashboard</title>
    <link rel="stylesheet" href="script.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <style>
        /* Centering the payment popup */
        
        .payment-popup {
            display: none;
            /* Hidden by default */
            position: fixed;
            /* Stay in place */
            z-index: 1000;
            /* Sit on top */
            left: 0;
            top: 0;
            width: 100%;
            /* Full width */
            height: 100%;
            /* Full height */
            overflow: auto;
            /* Enable scroll if needed */
            background-color: rgba(0, 0, 0, 0.5);
            /* Black w/ opacity */
            justify-content: center;
            /* Center horizontally */
            align-items: center;
            /* Center vertically */
        }
        
        .payment-content {
            background-color: white;
            /* White background */
            margin: auto;
            /* Center the content */
            padding: 20px;
            /* Some padding */
            border: 1px solid #888;
            /* Border */
            width: 300px;
            /* Set a width */
            border-radius: 8px;
            /* Rounded corners */
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            /* Shadow */
        }
        /* Centering the button */
        
        .pay-btn {
            display: block;
            /* Make button block level */
            margin: 20px auto;
            /* Center the button */
        }
        /* Centering the table */
        
        .result-table {
            margin: 20px auto;
            /* Center the table */
            width: 90%;
            /* Set a width */
            border-collapse: collapse;
            /* Collapse borders */
        }
        
        .result-table th,
        .result-table td {
            border: 1px solid #ddd;
            /* Border for table cells */
            padding: 8px;
            /* Padding for table cells */
            text-align: center;
            /* Center text in table cells */
        }
        
        .result-table th {
            background-color: #f2f2f2;
            /* Header background color */
        }
    </style>
</head>

<body>
    <!-- Sidebar -->
    <div class="sidebar">
        <div>
            <h2>ðŸŽ“</h2>
            <div class="menu">
                <a href="index.html"><i class="fas fa-home"></i> Dashboard</a>
                <a href="payment.html" class="active"><i class="fas fa-credit-card"></i> Payment Info</a>
                <a href="registration.html"><i class="fas fa-file-alt"></i> Registration</a>
                <a href="courses.html"><i class="fas fa-book"></i> Courses</a>
                <a href="drop.html"><i class="fas fa-times-circle"></i> Drop Semester</a>
                <a href="result.html"><i class="fas fa-poll"></i> Result</a>
                <a href="notice.html"><i class="fas fa-bell"></i> Notice</a>
                <a href="schedule.html"><i class="fas fa-calendar"></i> Schedule</a>
            </div>
        </div>
        <div class="logout">
            <a href="login.html" style="color:white;"><i class="fas fa-sign-out-alt"></i> Logout</a>
        </div>
    </div>

    <!-- Main Content -->
    <div class="main">
        <!-- Topbar -->
        <div class="topbar">
            <div class="search"><input type="text" placeholder="Search payments..."></div>
            <div class="user">
                <span>Manish Kumar</span>
                <img src="https://img.icons8.com/color/96/user-male-circle--v1.png" style="width:70px; height:70px;" alt="user">
            </div>
        </div>

        <!-- Payment Summary -->
        <div class="welcome">
            <div>
                <h2>Payment Information</h2>
                <p>View your fee summary and payment history</p>
            </div>
            <img src="https://img.icons8.com/color/96/money-bag.png" alt="Payment">
        </div>

        <div class="cards">
            <div class="card">
                <h3>Total Payable</h3>
                <p class="amount">â‚¹10,000</p>
            </div>
            <div class="card">
                <h3>Total Paid</h3>
                <p class="amount">â‚¹5,000</p>
            </div>
            <div class="card">
                <h3>Pending Balance</h3>
                <p class="amount">â‚¹5,000</p>
            </div>
        </div>

        <!-- Make Payment Button -->
        <div style="margin:20px;">
            <button class="pay-btn" onclick="openPaymentForm()">ðŸ’³ Make Payment</button>
        </div>

        <!-- Payment History -->
        <div class="result-section">
            <h3>Payment History</h3>
            <table class="result-table" id="paymentHistoryTable">
                <thead>
                    <tr>
                        <th>Receipt No.</th>
                        <th>Date</th>
                        <th>Amount</th>
                        <th>Method</th>
                        <th>Status</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- Payment history will be dynamically populated here -->
                </tbody>
            </table>
        </div>
    </div>

    <!-- Payment Popup Form -->
    <div id="paymentForm" class="payment-popup">
        <div class="payment-content">
            <span class="close" onclick="closePaymentForm()">&times;</span>
            <h2>Make Payment</h2>
            <form id="paymentFormElement" onsubmit="submitPayment(event)">
                <label>Amount</label>
                <input type="number" id="paymentAmount" placeholder="Enter amount in â‚¹" required>

                <label>Payment Method</label>
                <select id="paymentMethod" onchange="showPaymentFields()" required>
                    <option value="">Select Method</option>
                    <option value="UPI">UPI</option>
                    <option value="Credit Card">Credit Card</option>
                    <option value="Debit Card">Debit Card</option>
                    <option value="Net Banking">Net Banking</option>
                </select>

                <div id="paymentFields" style="display:none;">
                    <label id="specificLabel"></label>
                    <input type="text" id="specificInput" placeholder="Enter details" required>
                </div>

                <label>Transaction ID (if applicable)</label>
                <input type="text" id="transactionId" placeholder="Enter transaction ID">

                <button type="submit" class="pay-btn">Submit Payment</button>
            </form>
        </div>
    </div>

    <script src="script.js"></script>
    <script>
        // Array to hold payment history
        let paymentHistory = JSON.parse(localStorage.getItem('paymentHistory')) || [];
        let receiptCounter = paymentHistory.length ? paymentHistory.length + 1000 : 1000; // Starting receipt number

        // Load payment history on page load
        window.onload = function() {
            updatePaymentHistoryTable();
        };

        function openPaymentForm() {
            document.getElementById("paymentForm").style.display = "flex";
        }

        function closePaymentForm() {
            document.getElementById("paymentForm").style.display = "none";
        }

        function showPaymentFields() {
            const method = document.getElementById("paymentMethod").value;
            const paymentFields = document.getElementById("paymentFields");
            const specificLabel = document.getElementById("specificLabel");
            const specificInput = document.getElementById("specificInput");

            if (method === "UPI") {
                specificLabel.innerText = "UPI ID";
                specificInput.placeholder = "Enter UPI ID";
                paymentFields.style.display = "block";
            } else if (method === "Credit Card") {
                specificLabel.innerText = "Card Number";
                specificInput.placeholder = "Enter Card Number";
                paymentFields.style.display = "block";
            } else if (method === "Debit Card") {
                specificLabel.innerText = "Card Number";
                specificInput.placeholder = "Enter Card Number";
                paymentFields.style.display = "block";
            } else if (method === "Net Banking") {
                specificLabel.innerText = "Bank Name";
                specificInput.placeholder = "Enter Bank Name";
                paymentFields.style.display = "block";
            } else {
                paymentFields.style.display = "none";
            }
        }

        function submitPayment(event) {
            event.preventDefault(); // Prevent form submission

            // Get payment details
            const amount = document.getElementById("paymentAmount").value;
            const method = document.getElementById("paymentMethod").value;
            const transactionId = document.getElementById("transactionId").value;
            const specificDetail = document.getElementById("specificInput").value;

            // Create payment record
            const paymentRecord = {
                receiptNo: `R-${++receiptCounter}`,
                date: new Date().toLocaleDateString(),
                amount: `â‚¹${amount}`,
                method: method,
                status: 'Paid'
            };

            // Add payment to history
            paymentHistory.push(paymentRecord);
            localStorage.setItem('paymentHistory', JSON.stringify(paymentHistory)); // Save to local storage
            updatePaymentHistoryTable();

            // Clear form fields
            document.getElementById("paymentAmount").value = '';
            document.getElementById("paymentMethod").value = '';
            document.getElementById("specificInput").value = '';
            document.getElementById("transactionId").value = '';

            // Close the payment form
            closePaymentForm();
        }

        function updatePaymentHistoryTable() {
            const tableBody = document.getElementById('paymentHistoryTable').getElementsByTagName('tbody')[0];
            tableBody.innerHTML = ''; // Clear existing rows

            paymentHistory.forEach(payment => {
                const row = tableBody.insertRow();
                row.insertCell(0).innerText = payment.receiptNo;
                row.insertCell(1).innerText = payment.date;
                row.insertCell(2).innerText = payment.amount;
                row.insertCell(3).innerText = payment.method;
                row.insertCell(4).innerText = payment.status;
            });
        }
    </script>
</body>

</html>